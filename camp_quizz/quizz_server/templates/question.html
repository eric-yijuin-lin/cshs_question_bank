<!DOCTYPE html>
<html lang="zh-Hant">

<head>
    <meta charset="UTF-8">
    <title>兩題顯示</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
</head>

<body>
    <div class="main-container">
        <!-- 左邊：兩題 -->
        <div class="question-column">
            <!-- 題目一 -->
            <div class="question-row">
                <div class="info-column">
                    <div class="cell" id="planet1">{{ question1.planet }}</div>
                    <div class="cell hidden" id="stage1">{{ question1.stage }}</div>
                    <div class="cell hidden" id="source1">{{ question1.source }}</div>
                    <div class="cell answer hidden" id="answer1">{{ question1.answer }}</div>
                </div>
                <div class="text-column">
                    <div class="question-text">
                        <span class="question-type">{{ question1.question_type }}</span>
                        {{ question1.question }}
                    </div>
                </div>
            </div>

            <!-- 題目二 -->
            <div class="question-row">
                <div class="info-column">
                    <div class="cell" id="planet2">{{ question2.planet }}</div>
                    <div class="cell hidden" id="stage2">{{ question2.stage }}</div>
                    <div class="cell hidden" id="source2">{{ question2.source }}</div>
                    <div class="cell answer hidden" id="answer2">{{ question2.answer }}</div>
                </div>
                <div class="text-column">
                    <div class="question-text">
                        <span class="question-type">{{ question2.question_type }}</span>
                        {{ question2.question }}
                    </div>
                </div>
            </div>
        </div>

        <!-- 右邊：一個 timer -->
        <div class="timer-column">
            <div id="timer" class="countdown">90</div>
            <button id="revealBtn">公布答案</button>
            <button id="nextBtn" disabled>下一題</button>
        </div>
    </div>

    <script>
        let timeLeft = 90;
        let answerShown = false;
        const timerEl = document.getElementById("timer");

        const countdown = setInterval(() => {
            timeLeft--;
            timerEl.textContent = timeLeft;

            if (timeLeft === 60) {
                document.getElementById("stage1").classList.remove("hidden");
                document.getElementById("stage2").classList.remove("hidden");
            }

            if (timeLeft === 30) {
                document.getElementById("source1").classList.remove("hidden");
                document.getElementById("source2").classList.remove("hidden");
            }

            // 變色邏輯
            if (timeLeft <= 10) {
                timerEl.classList.add("red");
                timerEl.classList.remove("orange");
            } else if (timeLeft <= 30) {
                timerEl.classList.add("orange");
                timerEl.classList.remove("red");
            }

            // 結束倒數
            if (timeLeft <= 0) {
                clearInterval(countdown);
                timerEl.textContent = "時間到";
                document.getElementById("revealBtn").disabled = false;
            }
        }, 1000);

        document.getElementById("revealBtn").addEventListener("click", () => {
            clearInterval(countdown);
            answerShown = true;
            timerEl.textContent = "公布答案";
            document.getElementById("nextBtn").disabled = false;

            // 顯示答案
            document.getElementById("answer1").classList.remove("hidden");
            document.getElementById("answer2").classList.remove("hidden");

            // 若尚未顯示 stage/source，也一併顯示
            document.getElementById("stage1").classList.remove("hidden");
            document.getElementById("stage2").classList.remove("hidden");
            document.getElementById("source1").classList.remove("hidden");
            document.getElementById("source2").classList.remove("hidden");
        });

        document.getElementById("nextBtn").addEventListener("click", () => {
            window.location.reload();  // 重新載入目前頁面（即 /question）
        });
    </script>
</body>

</html>